<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Lmat [RDoc Documentation]</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Class</span>
          Lmat
        </h1>
        <ol class='paths'>
          <li>
            <a href="../files/lib/lmat_rb.html">lib/lmat.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong>Object</strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            <p>
            Labeled matrix
            </p>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public class</h3>
            <ol>
              <li><a href="#M000010">[]</a></li>
              <li><a href="#M000009">new</a></li>
            </ol>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000022">==</a></li>
              <li><a href="#M000011">[]</a></li>
              <li><a href="#M000012">[]=</a></li>
              <li><a href="#M000017">dup</a></li>
              <li><a href="#M000018">from_lmat</a></li>
              <li><a href="#M000019">from_lmata</a></li>
              <li><a href="#M000020">from_msrun</a></li>
              <li><a href="#M000015">inspect</a></li>
              <li><a href="#M000016">max</a></li>
              <li><a href="#M000026">print</a></li>
              <li><a href="#M000014">slice</a></li>
              <li><a href="#M000013">slice=</a></li>
              <li><a href="#M000021">to_s</a></li>
              <li><a href="#M000023">warp_cols</a></li>
              <li><a href="#M000024">warp_cols!</a></li>
              <li><a href="#M000025">write</a></li>
            </ol>
          </div>
          <div id='context'>
            <div id='includes'>
              <h2>Included modules</h2>
              <ol>
                <li><a href="Lmat/Gnuplot.html">Gnuplot</a></li>
              </ol>
            </div>
          </div>
          <div id='section'>
            <div id='class-list'>
              <h2>Classes and Modules</h2>
              Module <a href="Lmat/Gnuplot.html" class="link">Lmat::Gnuplot</a><br />
            </div>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>NUM_BYTE_SIZE</td>
                    <td>=</td>
                    <td class='context-item-value'>4</td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>mat</td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      an mvec.size X nvec.size narray
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>mvec</td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      an narray object numerically labelling the m-axis
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>nvec</td>
                    <td class='context-item-value'>[RW]</td>
                    <td class='context-item-desc'>
                      
                      an narray object numerically labelling the n-axis
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public class methods</h2>
              <div class='method public-class' id='method-M000010'>
                <a name='M000010'></a>
                <div class='synopsis'>
                  <span class='name'>[]</span>
                  <span class='arguments'>(*args)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000010-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000010-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 30</span>&#x000A;    <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;      <span class="ruby-identifier">mat</span> = <span class="ruby-constant">NArray</span>[<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>]&#x000A;      (<span class="ruby-identifier">nlen</span>, <span class="ruby-identifier">mlen</span>) = <span class="ruby-identifier">mat</span>.<span class="ruby-identifier">shape</span>&#x000A;      <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">new</span>(<span class="ruby-identifier">mat</span>)&#x000A;      <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">mvec</span> = <span class="ruby-constant">NArray</span>[<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">mlen</span>]&#x000A;      <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">nvec</span> = <span class="ruby-constant">NArray</span>[<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">nlen</span>]&#x000A;      <span class="ruby-identifier">obj</span>&#x000A;    <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-class' id='method-M000009'>
                <a name='M000009'></a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(mat=nil, mvec=nil, nvec=nil)</span>
                </div>
                <div class='description'>
                  <p>
                  Takes an array of narray objects
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000009-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000009-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 23</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">mat</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">mvec</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">nvec</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;    <span class="ruby-ivar">@mat</span> = <span class="ruby-identifier">mat</span>&#x000A;    <span class="ruby-ivar">@mvec</span> = <span class="ruby-identifier">mvec</span>&#x000A;    <span class="ruby-ivar">@nvec</span> = <span class="ruby-identifier">nvec</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Public instance methods</h2>
              <div class='method public-instance' id='method-M000022'>
                <a name='M000022'></a>
                <div class='synopsis'>
                  <span class='name'>==</span>
                  <span class='arguments'>(other)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000022-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000022-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 189</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">other</span>)&#x000A;     <span class="ruby-identifier">other</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@nvec</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">nvec</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@mvec</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">mvec</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@mat</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">other</span>.<span class="ruby-identifier">mat</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000011'>
                <a name='M000011'></a>
                <div class='synopsis'>
                  <span class='name'>[]</span>
                  <span class='arguments'>(*args)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000011-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000011-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 40</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;    <span class="ruby-ivar">@mat</span>[<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>]&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000012'>
                <a name='M000012'></a>
                <div class='synopsis'>
                  <span class='name'>[]=</span>
                  <span class='arguments'>(*args)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000012-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000012-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 44</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;    <span class="ruby-ivar">@mat</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value str">'[]='</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000017'>
                <a name='M000017'></a>
                <div class='synopsis'>
                  <span class='name'>dup</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000017-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000017-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 72</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dup</span>&#x000A;    <span class="ruby-identifier">a</span> = <span class="ruby-constant">Lmat</span>.<span class="ruby-identifier">new</span>&#x000A;    <span class="ruby-identifier">a</span>.<span class="ruby-identifier">mvec</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">mvec</span>[]&#x000A;    <span class="ruby-identifier">a</span>.<span class="ruby-identifier">nvec</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">nvec</span>[]&#x000A;    <span class="ruby-identifier">a</span>.<span class="ruby-identifier">mat</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">mat</span>[]&#x000A;    <span class="ruby-identifier">a</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000018'>
                <a name='M000018'></a>
                <div class='synopsis'>
                  <span class='name'>from_lmat</span>
                  <span class='arguments'>(file)</span>
                </div>
                <div class='description'>
                  <p>
                  returns self
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000018-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000018-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 81</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">from_lmat</span>(<span class="ruby-identifier">file</span>)&#x000A;    <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">file</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>&#x000A;      (<span class="ruby-ivar">@mvec</span>, <span class="ruby-ivar">@nvec</span>) = [<span class="ruby-keyword kw">true</span>, <span class="ruby-keyword kw">true</span>].<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">iv</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">_len</span> = <span class="ruby-identifier">io</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value">4</span>).<span class="ruby-identifier">unpack</span>(<span class="ruby-value str">'I'</span>).<span class="ruby-identifier">first</span>&#x000A;        <span class="ruby-constant">NArray</span>.<span class="ruby-identifier">to_na</span>( <span class="ruby-identifier">io</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">_len</span><span class="ruby-operator">*</span><span class="ruby-constant">NUM_BYTE_SIZE</span>), <span class="ruby-value str">'sfloat'</span> )&#x000A;      <span class="ruby-keyword kw">end</span>&#x000A;      <span class="ruby-ivar">@mat</span> = <span class="ruby-constant">NArray</span>.<span class="ruby-identifier">to_na</span>(<span class="ruby-identifier">io</span>.<span class="ruby-identifier">read</span>, <span class="ruby-value str">'sfloat'</span>, <span class="ruby-ivar">@nvec</span>.<span class="ruby-identifier">size</span>, <span class="ruby-ivar">@mvec</span>.<span class="ruby-identifier">size</span>)&#x000A;    <span class="ruby-keyword kw">end</span>&#x000A;    <span class="ruby-keyword kw">self</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000019'>
                <a name='M000019'></a>
                <div class='synopsis'>
                  <span class='name'>from_lmata</span>
                  <span class='arguments'>(file)</span>
                </div>
                <div class='description'>
                  <p>
                  returns self
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000019-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000019-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 93</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">from_lmata</span>(<span class="ruby-identifier">file</span>)&#x000A;    <span class="ruby-comment cmt"># this can probably be made faster</span>&#x000A;    <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">file</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">io</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">num_m</span> = <span class="ruby-identifier">io</span>.<span class="ruby-identifier">readline</span>.<span class="ruby-identifier">to_i</span>&#x000A;      <span class="ruby-identifier">mline</span> = <span class="ruby-identifier">io</span>.<span class="ruby-identifier">readline</span>.<span class="ruby-identifier">chomp</span>&#x000A;      <span class="ruby-ivar">@mvec</span> = <span class="ruby-constant">NArray</span>.<span class="ruby-identifier">to_na</span>( <span class="ruby-identifier">mline</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">' '</span>).<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_f</span> } )&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-constant">RuntimeError</span>, <span class="ruby-value str">&quot;bad m vec size&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">mvec</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">num_m</span>&#x000A;      <span class="ruby-identifier">num_n</span> = <span class="ruby-identifier">io</span>.<span class="ruby-identifier">readline</span>.<span class="ruby-identifier">to_i</span>&#x000A;      <span class="ruby-identifier">nline</span> = <span class="ruby-identifier">io</span>.<span class="ruby-identifier">readline</span>.<span class="ruby-identifier">chomp</span>&#x000A;      <span class="ruby-ivar">@nvec</span> = <span class="ruby-constant">NArray</span>.<span class="ruby-identifier">to_na</span>( <span class="ruby-identifier">nline</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">' '</span>).<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_f</span> } )&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-constant">RuntimeError</span>, <span class="ruby-value str">&quot;bad n vec size&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">nvec</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">num_n</span>&#x000A;      <span class="ruby-ivar">@mat</span> = <span class="ruby-constant">NArray</span>.<span class="ruby-identifier">float</span>(<span class="ruby-identifier">num_n</span>, <span class="ruby-identifier">num_m</span>)&#x000A;      <span class="ruby-identifier">num_m</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">m</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">line</span> = <span class="ruby-identifier">io</span>.<span class="ruby-identifier">readline</span>.<span class="ruby-identifier">chomp!</span>&#x000A;        <span class="ruby-ivar">@mat</span>[<span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">m</span>] = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">' '</span>).<span class="ruby-identifier">map</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_f</span> }&#x000A;      <span class="ruby-keyword kw">end</span>&#x000A;    <span class="ruby-keyword kw">end</span>&#x000A;    <span class="ruby-keyword kw">self</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000020'>
                <a name='M000020'></a>
                <div class='synopsis'>
                  <span class='name'>from_msrun</span>
                  <span class='arguments'>(msrun, args)</span>
                </div>
                <div class='description'>
                  <p>
                  converts msrun object to a labeled matrix takes hash with symbols as keys
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000020-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000020-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 115</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">from_msrun</span>(<span class="ruby-identifier">msrun</span>, <span class="ruby-identifier">args</span>)&#x000A;    <span class="ruby-identifier">opt</span> = {&#x000A;      <span class="ruby-identifier">:inc_mz</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1.0</span>,&#x000A;      <span class="ruby-identifier">:behave_mz</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">'sum'</span>, &#x000A;      <span class="ruby-identifier">:baseline=</span><span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span><span class="ruby-value">.0</span>,&#x000A;&#x000A;      <span class="ruby-comment cmt">#:start_tm =&gt; 0.0, </span>&#x000A;      <span class="ruby-comment cmt">#:end_tm =&gt; 3600.0,</span>&#x000A;      <span class="ruby-comment cmt">#:inc_tm =&gt; nil,</span>&#x000A;      &#x000A;      <span class="ruby-comment cmt">#:start_mz =&gt; 400.0, </span>&#x000A;      <span class="ruby-comment cmt">#:end_mz =&gt; 1500.0,</span>&#x000A;    }&#x000A;    <span class="ruby-identifier">opt</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">args</span>)&#x000A;&#x000A;    (<span class="ruby-identifier">st</span>, <span class="ruby-identifier">en</span>) = <span class="ruby-identifier">msrun</span>.<span class="ruby-identifier">start_and_end_mz</span>&#x000A;    <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">st</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">en</span>&#x000A;      <span class="ruby-identifier">msg</span> = [<span class="ruby-value str">&quot;scanning spectrum for start and end m/z values&quot;</span>]&#x000A;      <span class="ruby-identifier">msg</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;(use :start_mz and :end_mz options to avoid this)&quot;</span>&#x000A;      <span class="ruby-identifier">warn</span> <span class="ruby-identifier">msg</span>&#x000A;      (<span class="ruby-identifier">st</span>, <span class="ruby-identifier">en</span>) = <span class="ruby-identifier">msrun</span>.<span class="ruby-identifier">start_and_end_mz_brute_force</span>&#x000A;    <span class="ruby-keyword kw">end</span>&#x000A;    <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:start_mz</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">st</span>&#x000A;    <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:end_mz</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">en</span>&#x000A;&#x000A;    <span class="ruby-comment cmt">#unless opt[:start_tm] then opt[:start_tm] = times.first end</span>&#x000A;    <span class="ruby-comment cmt">#unless opt[:end_tm] then opt[:end_tm] = times.last end</span>&#x000A;&#x000A;    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:inc_tm</span>]&#x000A;      <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-node">&quot;haven't implemented interpolation in ruby yet! (#{File.basename(__FILE__)}: #{__LINE__})&quot;</span>&#x000A;    <span class="ruby-keyword kw">else</span> <span class="ruby-comment cmt">## No interpolation</span>&#x000A;      <span class="ruby-identifier">times</span> = []&#x000A;      <span class="ruby-ivar">@nvec</span> = <span class="ruby-keyword kw">nil</span>&#x000A;      <span class="ruby-identifier">vecs</span> = []&#x000A;      <span class="ruby-identifier">num_scans</span> = <span class="ruby-identifier">msrun</span>.<span class="ruby-identifier">scan_count</span>&#x000A;      <span class="ruby-identifier">printf</span> <span class="ruby-node">&quot;Reading #{num_scans} spectra [.=100]&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$VERBOSE</span>&#x000A;      <span class="ruby-identifier">spectrum_cnt</span> = <span class="ruby-value">0</span>&#x000A;      <span class="ruby-identifier">msrun</span>.<span class="ruby-identifier">each</span>(<span class="ruby-identifier">:ms_level</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">scan</span><span class="ruby-operator">|</span>&#x000A;        <span class="ruby-identifier">spectrum</span> = <span class="ruby-identifier">scan</span>.<span class="ruby-identifier">spectrum</span>&#x000A;        <span class="ruby-identifier">times</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">scan</span>.<span class="ruby-identifier">time</span>&#x000A;        <span class="ruby-comment cmt">#(mz,inten) = spectrum_to_mz_and_inten(spectrum, VecD)</span>&#x000A;        <span class="ruby-comment cmt"># TODO: Figure out a shallow copy here:</span>&#x000A;        <span class="ruby-comment cmt"># perhaps we'll make spectra Vec objects by default in future and</span>&#x000A;        <span class="ruby-comment cmt"># then we'd be set...</span>&#x000A;        <span class="ruby-identifier">mzs</span> = <span class="ruby-constant">NArray</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">spectrum</span>.<span class="ruby-identifier">mzs</span>)&#x000A;        <span class="ruby-identifier">intens</span> = <span class="ruby-constant">NArray</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">spectrum</span>.<span class="ruby-identifier">intensities</span>)&#x000A;        (<span class="ruby-identifier">x</span>,<span class="ruby-identifier">y</span>) = <span class="ruby-identifier">mzs</span>.<span class="ruby-identifier">inc_x</span>(<span class="ruby-identifier">intens</span>, <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:start_mz</span>], <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:end_mz</span>], <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:inc_mz</span>], <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:baseline</span>], <span class="ruby-identifier">opt</span>[<span class="ruby-identifier">:behave_mz</span>])&#x000A;        <span class="ruby-identifier">spectrum_cnt</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>&#x000A;        <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">spectrum_cnt</span> <span class="ruby-operator">%</span> <span class="ruby-value">100</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>&#x000A;          <span class="ruby-identifier">printf</span> <span class="ruby-value str">&quot;.&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$VERBOSE</span> ; <span class="ruby-identifier">$stdout</span>.<span class="ruby-identifier">flush</span>&#x000A;        <span class="ruby-keyword kw">end</span>&#x000A;        <span class="ruby-ivar">@nvec</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">x</span> <span class="ruby-comment cmt"># just need the first one for the x values</span>&#x000A;        <span class="ruby-identifier">vecs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">y</span>&#x000A;      <span class="ruby-keyword kw">end</span>&#x000A;      <span class="ruby-identifier">puts</span> <span class="ruby-value str">&quot;DONE!&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">$VERBOSE</span>&#x000A;      <span class="ruby-ivar">@mvec</span> = <span class="ruby-constant">NArray</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">times</span>)&#x000A;      <span class="ruby-ivar">@mat</span> = <span class="ruby-identifier">vecs</span>&#x000A;    <span class="ruby-keyword kw">end</span>&#x000A;    <span class="ruby-keyword kw">self</span>  &#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000015'>
                <a name='M000015'></a>
                <div class='synopsis'>
                  <span class='name'>inspect</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000015-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000015-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 56</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>&#x000A;    <span class="ruby-comment cmt"># TODO: needs work (see ruport pivotted table output)</span>&#x000A;    [<span class="ruby-node">&quot;nvec=#{@nvec.inspect}&quot;</span>, <span class="ruby-node">&quot;mvec=#{@mvec.inspect}&quot;</span>, <span class="ruby-node">&quot;mat=#{@mat.inspect}&quot;</span>].<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)&#x000A;&#x000A;    <span class="ruby-identifier">start</span> = <span class="ruby-value str">'   '</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">nvec</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;, &quot;</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>&#x000A;    <span class="ruby-identifier">start</span> <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-value str">&quot;    &quot;</span> <span class="ruby-operator">+</span> (<span class="ruby-value str">&quot;-&quot;</span> <span class="ruby-operator">*</span> (<span class="ruby-identifier">start</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">-</span> <span class="ruby-value">4</span>))) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>&#x000A;    <span class="ruby-identifier">mvec</span>[].<span class="ruby-identifier">indgen!</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">start</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{mvec[i]} | &quot;</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@mat</span>[<span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">i</span>].<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;\n&quot;</span>&#x000A;    <span class="ruby-keyword kw">end</span>&#x000A;    <span class="ruby-identifier">start</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000016'>
                <a name='M000016'></a>
                <div class='synopsis'>
                  <span class='name'>max</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000016-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000016-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 68</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">max</span>&#x000A;    <span class="ruby-ivar">@mat</span>.<span class="ruby-identifier">max</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000026'>
                <a name='M000026'></a>
                <div class='synopsis'>
                  <span class='name'>print</span>
                  <span class='arguments'>(file=nil)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000026-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000026-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 225</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">print</span>(<span class="ruby-identifier">file</span>=<span class="ruby-keyword kw">nil</span>)&#x000A;    <span class="ruby-identifier">handle</span> = <span class="ruby-identifier">$&gt;</span>&#x000A;    <span class="ruby-identifier">handle</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">file</span>, <span class="ruby-value str">&quot;w&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file</span>&#x000A;    <span class="ruby-identifier">handle</span>.<span class="ruby-identifier">print</span>( <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">to_s</span>(<span class="ruby-keyword kw">true</span>) )&#x000A;    <span class="ruby-identifier">handle</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000014'>
                <a name='M000014'></a>
                <div class='synopsis'>
                  <span class='name'>slice</span>
                  <span class='arguments'>(*args)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000014-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000014-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 52</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">slice</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;    <span class="ruby-ivar">@mat</span>.<span class="ruby-identifier">slice</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000013'>
                <a name='M000013'></a>
                <div class='synopsis'>
                  <span class='name'>slice=</span>
                  <span class='arguments'>(*args)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000013-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000013-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 48</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">slice=</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;    <span class="ruby-ivar">@mat</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">:slice</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000021'>
                <a name='M000021'></a>
                <div class='synopsis'>
                  <span class='name'>to_s</span>
                  <span class='arguments'>(with_vec_lengths=false)</span>
                </div>
                <div class='description'>
                  <p>
                  outputs vec lengths if set to true
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000021-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000021-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 177</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>(<span class="ruby-identifier">with_vec_lengths</span>=<span class="ruby-keyword kw">false</span>)&#x000A;    <span class="ruby-identifier">arr</span> = []&#x000A;    <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">push</span>(<span class="ruby-ivar">@mvec</span>.<span class="ruby-identifier">size</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">with_vec_lengths</span>&#x000A;    <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">push</span>(<span class="ruby-ivar">@mvec</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>))&#x000A;    <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">push</span>(<span class="ruby-ivar">@nvec</span>.<span class="ruby-identifier">size</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">with_vec_lengths</span>&#x000A;    <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">push</span>(<span class="ruby-ivar">@nvec</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>))&#x000A;    (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-ivar">@mvec</span>.<span class="ruby-identifier">size</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">m_index</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">push</span>(<span class="ruby-ivar">@mat</span>[<span class="ruby-keyword kw">true</span>, <span class="ruby-identifier">m_index</span>].<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot; &quot;</span>))&#x000A;    <span class="ruby-keyword kw">end</span>&#x000A;    <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;\n&quot;</span>)&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000023'>
                <a name='M000023'></a>
                <div class='synopsis'>
                  <span class='name'>warp_cols</span>
                  <span class='arguments'>(new_m_values, deep_copy=false)</span>
                </div>
                <div class='description'>
                  <p>
                  returns a fresh lmat object
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000023-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000023-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 194</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">warp_cols</span>(<span class="ruby-identifier">new_m_values</span>, <span class="ruby-identifier">deep_copy</span>=<span class="ruby-keyword kw">false</span>)&#x000A;    <span class="ruby-identifier">new_guy</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">dup</span>&#x000A;    <span class="ruby-identifier">new_guy</span>.<span class="ruby-identifier">warp_cols!</span>(<span class="ruby-identifier">new_m_values</span>, <span class="ruby-identifier">deep_copy</span>)&#x000A;    <span class="ruby-identifier">new_guy</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000024'>
                <a name='M000024'></a>
                <div class='synopsis'>
                  <span class='name'>warp_cols!</span>
                  <span class='arguments'>(new_m_values, deep_copy=false)</span>
                </div>
                <div class='description'>
                  <p>
                  warps the data in self based on interpolation of the cols. Evaluates the
                  new_m_values for each column and returns a new lmat object with the m
                  values set to new_m_values. nvec will be the same is in self.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000024-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000024-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 203</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">warp_cols!</span>(<span class="ruby-identifier">new_m_values</span>, <span class="ruby-identifier">deep_copy</span>=<span class="ruby-keyword kw">false</span>)&#x000A;    <span class="ruby-identifier">nvec</span>[].<span class="ruby-identifier">indgen</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">n</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">n</span>,<span class="ruby-keyword kw">true</span>] = <span class="ruby-constant">Spline</span>.<span class="ruby-identifier">alloc</span>(<span class="ruby-constant">Interp</span><span class="ruby-operator">::</span><span class="ruby-constant">AKIMA</span>, <span class="ruby-identifier">mvec</span>, <span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">n</span>, <span class="ruby-keyword kw">true</span>]).<span class="ruby-identifier">eval</span>(<span class="ruby-identifier">new_m_values</span>)&#x000A;    <span class="ruby-keyword kw">end</span>&#x000A;    <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">nvec</span> = <span class="ruby-identifier">deep_copy</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">nvec</span>[] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">nvec</span>&#x000A;    <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">mvec</span> = <span class="ruby-identifier">deep_copy</span> <span class="ruby-value">? </span><span class="ruby-identifier">new_m_values</span>[] <span class="ruby-operator">:</span> <span class="ruby-identifier">new_m_values</span>&#x000A;    <span class="ruby-keyword kw">self</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M000025'>
                <a name='M000025'></a>
                <div class='synopsis'>
                  <span class='name'>write</span>
                  <span class='arguments'>(file=nil, int_format_string='i')</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000025-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000025-source'><span class="ruby-comment cmt"># File lib/lmat.rb, line 212</span>&#x000A;  <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write</span>(<span class="ruby-identifier">file</span>=<span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">int_format_string</span>=<span class="ruby-value str">'i'</span>)&#x000A;    <span class="ruby-identifier">handle</span> = <span class="ruby-identifier">$&gt;</span>&#x000A;    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file</span>; <span class="ruby-identifier">handle</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">file</span>, <span class="ruby-value str">&quot;wb&quot;</span>) <span class="ruby-keyword kw">end</span>&#x000A;    <span class="ruby-identifier">bin_string</span> = <span class="ruby-value str">&quot;&quot;</span>&#x000A;    <span class="ruby-identifier">bin_string</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-ivar">@mvec</span>.<span class="ruby-identifier">size</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-identifier">int_format_string</span>)&#x000A;    <span class="ruby-identifier">bin_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@mvec</span>.<span class="ruby-identifier">to_s</span>&#x000A;    <span class="ruby-identifier">bin_string</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-ivar">@nvec</span>.<span class="ruby-identifier">size</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-identifier">int_format_string</span>)&#x000A;    <span class="ruby-identifier">bin_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@nvec</span>.<span class="ruby-identifier">to_s</span>&#x000A;    <span class="ruby-identifier">bin_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@mat</span>.<span class="ruby-identifier">to_s</span>&#x000A;    <span class="ruby-identifier">handle</span>.<span class="ruby-identifier">print</span> <span class="ruby-identifier">bin_string</span>&#x000A;    <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file</span>; <span class="ruby-identifier">handle</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword kw">end</span>&#x000A;  <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
